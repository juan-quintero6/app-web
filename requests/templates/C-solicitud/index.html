{% load static %} 
<!DOCTYPE html>
<html lang="es">
   
<head>
    <!-- Título de la página -->
    <title>¡Encuentra tu ruta con CargaDirecta!</title>
    <!-- Configuración de metadatos -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Encuentra las mejores rutas con UberMaps y disfruta de un viaje sin complicaciones.">
    <meta name="keywords" content="UberMaps, rutas, viajes, mapa, navegación">
    <meta name="author" content="Tu Nombre">
    <!-- Enlace al archivo de estilos -->
    
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">
</head>

<body>
    <!-- Contenedor principal -->
    <div class="container">
        <!-- Barra lateral -->
        <div id="sidebar">
            <!-- Controles de búsqueda y estado del viaje -->
            <div id="controls">
                <input type="text" id="origin" placeholder="Ingrese punto de partida" value="{{ request.GET.origin }}">
                <input type="text" id="destination" placeholder="Ingrese destino" value="{{ request.GET.destination }}">
                <button id="submit-btn">Buscar Ruta</button>
                <form id="start-journey-form" action="{% url 'start_journey' request.GET.id %}" method="post" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit" id="start-journey-btn">Iniciar Viaje</button>
                </form>
                <div id="status"></div>
                <form id="delivered-form" action="{% url 'delivered' request.GET.id %}" method="post" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit" id="delivered-btn" disabled>Entregado</button>
                </form>                
                <button id="postpone-btn" style="display: none;">Posponer Entrega</button>
            </div>
            <!-- Información del viaje -->
            <div id="trip-info" style="display: none;">
                <h3>Información del Viaje</h3>
                <p><strong>Origen:</strong> <span id="trip-origin">{{ request.GET.origin }}</span></p>
                <p><strong>Destino:</strong> <span id="trip-destination">{{ request.GET.destination }}</span></p>
                <p><strong>Kilómetros Recorridos:</strong> <span id="trip-distance"></span></p>
                <p><strong>Tiempo Estimado:</strong> <span id="trip-duration"></span></p>
                <p><strong>Tarifa Estimada:</strong> <span id="trip-fare"></span></p>
            </div>
            <!-- Tabla de instrucciones de navegación -->
            <table id="instructions-table" style="display: none;">
                <thead>
                    <tr>
                        <th>Paso</th>
                        <th>Indicación</th>
                        <th>Distancia</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
        <!-- Contenedor del mapa -->
        <div id="map-container">
            <div id="map"></div>
            <!-- Sección de calificación de la experiencia -->
            <div id="rating-section" style="display: none;">
                <h3>Por favor, califica tu experiencia:</h3>
                <div id="rating-stars">
                    <span class="star" data-value="1">☆</span>
                    <span class="star" data-value="2">☆</span>
                    <span class="star" data-value="3">☆</span>
                    <span class="star" data-value="4">☆</span>
                    <span class="star" data-value="5">☆</span>
                </div>
            </div>
        </div>
    </div>
    <!-- Inclusión de archivos de scripts -->
    <script src="{% static '/js/script.js' %}" defer></script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDA8Dyna2iOdz-3LHglPTOIyEU756VTXLU&libraries=places&callback=initMap"></script>

    <script>
        // Esta función se ejecuta al cargar la página
        window.onload = function() {
            // Obtener los parámetros de la URL
            var urlParams = new URLSearchParams(window.location.search);
            var origin = urlParams.get('origin');
            var destination = urlParams.get('destination');

            // Actualizar los valores en la página
            document.getElementById('origin').value = origin;
            document.getElementById('destination').value = destination;
            document.getElementById('trip-origin').textContent = origin;
            document.getElementById('trip-destination').textContent = destination;

            // Aquí puedes hacer otras operaciones que necesites con los datos
            // Por ejemplo, llamar a una función para buscar la ruta automáticamente
        };
    </script>
    <script>
        // Espera a que el DOM esté completamente cargado
        document.addEventListener('DOMContentLoaded', function() {
            // Obtén el formulario de inicio de viaje por su ID
            const startJourneyForm = document.getElementById('start-journey-form');
            // Obtén el botón "Entregado" por su ID
            const deliveredBtn = document.getElementById('delivered-btn');

            // Agrega un evento de escucha para el evento de envío del formulario
            startJourneyForm.addEventListener('submit', function(event) {
                // Habilita el botón "Entregado" cuando se envíe el formulario
                deliveredBtn.disabled = false;
            });
        });
    </script>
</body>

</html>
